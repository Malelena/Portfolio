### Yandex.Practicum-Data-Science
# Предсказание коэффициента восстановления золота из золотосодержащей руды
## Описание проекта
Нужно подготовить прототип модели машинного обучения для «Цифры» (компания, которая разрабатывает решения для эффективной работы промышленных предприятий).
Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. В нашем распоряжении данные с параметрами добычи и очистки.
Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

## Описание данных
## Технологический процесс

* Rougher feed — исходное сырье
* Rougher additions — флотационные реагенты
* Xanthate — ксантогенат
* Sulphate — сульфат
* Depressant — депрессант
* Rougher process — флотация
* Rougher tails — отвальные хвосты
* Float banks — флотационная установка
* Cleaner process — очистка
* Rougher Au — черновой концентрат золота
* Final Au — финальный концентрат золота

## Параметры этапов

* air amount — объём воздуха
* fluid levels — уровень жидкости
* feed size — размер гранул сырья
* feed rate — скорость подачи

  ### Используемые инструменты
`Matplotlib` `NumPy` `Pandas` `Python` `Scikit-learn` `исследовательский анализ данных`

### Модели
`LinearRegression` `DecisionTreeRegressor` `RandomForestRegressor` `DummyRegressor`

### Дополнительно
`GridSearchCV` `StandardScaler` `cross_val_score` `make_scorer`

### Метрики
`sMAPE` `mean_absolute_error`

### Вывод:

В результате анализа датасетов, были замечены пропуски, которые заменили на соседние значения. Так же было выявлено, что в тестовом датасете меньше всего информации, в т.ч. отсутствовали целевые признаки, которые в дальнейшем были добавлены. Убедились, что эффективность обогащения рассчитана правильно. Для этого посчитали по формуле МАЕ. Для дальнейшего анализа были построены графики, наглядно удалось убедиться, что количество содержания золота увеличивается на всех этапах (флотация, первичная и вторичная очистка). Так же при флотации увеличивается кол-во серебра и свинца. После первичной очистки, кол-во серебра и свинца уменьшается. А после вторичной очистки наблюдается увеличение серебра и свинца. Проанализировали распределения размеров гранул на обучающей и тестовой выборке: они распределяются с незначительными отличиями, что не влияет на оценку модели. Проанализировали суммарную концентрацию всех веществ на разных стадиях. Были обнаружены аномалии. Убрали найденные аномалии. Далее были подготовлены данные для обучения моделей. Написана функция по посчету sMAPE. В результате обучения 3х моделей (Линейная регрессия, Случайный лес и Дерево решений) выбрали лучшую модель - Случайный лес.Проверили эту модель на тестовой выборке и сравнили с константной моделью. Убедились, что обученная модель показала более точный результат.

### Основные шаги и выводы:
* Подготовлены данные
* Проведен анализ данных
* Построена модель прогнозирования
* Написана функция для вычисления итогового sMAPE
* Обучено и проверено несколько моделей
* Выбрана лучшая модель, её качество проверено на тестовой выборке
* Написан вывод
